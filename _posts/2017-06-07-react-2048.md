---
layout: post
title:  "用reactjs实现简易版的2048"
categories: [webpack, reactjs, html5]
---
[在线预览 - 2048游戏 ](./games/2048/)

[github - 源代码 ](https://github.com/SylviaF/react-2048){:target="_blank"}

注意：分数存储是通过facebook的api，因为设置源的问题，分数无法存储到facebook

<iframe style="width:100%;max-width: 300px;height: 500px;overflow:hidden" src="./games/2048/"></iframe>

1 搭建webpack + react + es6 + less的简易脚手架
    <img src="/images/react-2048/1.png"/>
    开发时需要的npm包：
    babel-preset-es2015
    babel-preset-react
    less-loader
    css-loader
    style-loader

```javascript
    'use strict';
    let webpack = require('webpack');
    let fs = require('fs');
    let path = require('path');

    let entryPath = __dirname + '/src/entry/';

    let entry = fs.readdirSync(entryPath).reduce((r, fileName) => {
            r[fileName.replace(/\.js$/, '')] = entryPath + fileName;
    return r;
    }, {});

    let node_modules_dir = path.resolve(__dirname, 'node_modules');

    module.exports = {
        entry: entry,
        plugins: [new webpack.DefinePlugin({
                // 'process.env.NODE_ENV': JSON.stringify('development')
                'process.env.NODE_ENV': JSON.stringify('production')
            })],
        output: {
            path: __dirname + '/dist/static/js',
            filename: "[name].js"
        },
        module: {
            preLoaders: [
                {
                    test: /\.jsx?$/, loader: "babel-loader",
                    query: {
                        presets: [
                            'react', // react
                            'es2015' // es6
                        ]
                    }
                }
            ],
            loaders: [
                // LESS
                {
                    test: /\.less$/,
                    exclude: [node_modules_dir],
                    loader: 'style!css-loader!less-loader'
                },
                {
                    test: /\.css$/,
                    exclude: [node_modules_dir],
                    loader: 'style!css-loader?modules'
                },
                {
                    test: /\.json$/,
                    exclude: [node_modules_dir],
                    loader: 'json-loader'
                }
            ]
        }
    };
```

2 拆解2048的对象
    游戏面板:
        1. 初始化：
```
            constructor(props) {
                super(props);
                this.winflag = false;
                this.width = 4;
                this.size = Math.pow(this.width, 2);
                this.state = {
                    data: Array.from(new Array(this.size), () => 0),
                    stop: 0
                };
                this.random = this.random.bind(this);
                this.handleAction = this.handleAction.bind(this);
                this.replay = this.replay.bind(this);
            }
```

... 待完善 ...

